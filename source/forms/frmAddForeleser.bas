Version =20
VersionRequired =20
Begin Form
    Modal = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    TabularFamily =255
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =7453
    DatasheetFontHeight =10
    ItemSuffix =15
    Left =2235
    Top =285
    Right =10110
    Bottom =4935
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x751a9027f310e340
    End
    DatasheetFontName ="Arial"
    OnLoad ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
            AsianLineBreak =255
        End
        Begin ComboBox
            SpecialEffect =2
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
        End
        Begin CustomControl
            SpecialEffect =2
            Width =4536
            Height =2835
        End
        Begin ToggleButton
            Width =283
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
        End
        Begin Section
            Height =4158
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin CustomControl
                    Enabled = NotDefault
                    SizeMode =1
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =170
                    Top =230
                    Width =7092
                    Height =2496
                    AutoActivate =1
                    Name ="lvwForeleser"
                    OleData = Begin
                        0x000e0000d0cf11e0a1b11ae1000000000000000000000000000000003e000300 ,
                        0xfeff090006000000000000000000000001000000020000000000000000100000 ,
                        0x0400000001000000feffffff0000000003000000ffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff010000004bf0d1bd8b85d111b16a00c0 ,
                        0xf02836280000000000000000000000004091f65b1598c8010700000080010000 ,
                        0x0000000043006f006e00740065006e0074007300000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000012000201ffffffff02000000ffffffff000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000002000000fa000000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000000000005c000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000fefffffffdfffffffffffffffffffffffffffffffffffffffeffffff ,
                        0xfeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff010000004bf0d1bd8b85d111b16a00c0 ,
                        0xf0283628000000000000000000000000509f2c933aaac90105000000c0010000 ,
                        0x0000000043006f006e00740065006e0074007300000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000012000201ffffffff02000000ffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000020000001b010000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000000000005c000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000fffffffffffffffffefffffffdfffffffefffffffeffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff01000000feffffff03000000040000000500000006000000feffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff5c000000000000000100000000000000000000000000000000000000 ,
                        0x2400000038000000000000000000000000000000000000000000000039333638 ,
                        0x323635452d383546452d313164312d384245332d303030304638373534444131 ,
                        0xe022860902002000000000000000ac1400000500000000000000000000000000 ,
                        0x000005002143341208000000e3300000281100004e087deb010006001c000000 ,
                        0x000000000000000000860100e330000001efcdab000005005812c80c07002a00 ,
                        0x0800008005000080d04dc70c0000000000000000000000001fdeecbd01000500 ,
                        0x494dc70c0352e30b918fce119de300aa004bb851010000009001905f01000654 ,
                        0x61686f6d6104002000000000000000ac14000009000000000000000000000000 ,
                        0x000000090000004661676ce6726572002000010002000000e406000004000000 ,
                        0x00000000000000000000000004000000537470002000020000000000ac140000 ,
                        0x08000000000000000000000000000000080000004d65726b6e61640020000300 ,
                        0x00000000e4060000030000000000000000000000000000000300000049440000 ,
                        0x0053746564002000050000000000000000000300000000000000000000000000 ,
                        0x0000030000004944002000060000000000000000000a00000000000000000000 ,
                        0x00000000000a0000004d65726b6e61646572000000000000fcffffff00000000 ,
                        0x0000000000000000
                    End
                    OLEClass ="ListViewCtrl"
                    Class ="MSComctlLib.ListViewCtrl.2"
                End
                Begin ComboBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =170
                    Top =2891
                    Width =3003
                    Height =340
                    FontSize =9
                    TabIndex =1
                    Name ="cboLarer"
                    RowSourceType ="Table/Query"
                    ColumnWidths ="2268;0"
                    AfterUpdate ="[Event Procedure]"
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =4200
                    Top =2891
                    Width =3016
                    Height =340
                    FontSize =9
                    TabIndex =2
                    Name ="txtKommentar"
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =3218
                    Top =2891
                    Width =925
                    Height =340
                    FontSize =9
                    TabIndex =3
                    Name ="txtStp"
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =173
                    Top =3401
                    Width =1700
                    Height =340
                    FontSize =9
                    TabIndex =4
                    Name ="btnAdd"
                    Caption ="Legg til"
                    OnClick ="[Event Procedure]"
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =3723
                    Top =3401
                    Width =1700
                    Height =340
                    FontSize =9
                    TabIndex =5
                    Name ="btnDelete"
                    Caption ="Fjern"
                    OnClick ="[Event Procedure]"
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =1948
                    Top =3401
                    Width =1700
                    Height =340
                    FontSize =9
                    TabIndex =6
                    Name ="btnUpdate"
                    Caption ="Oppdater"
                    OnClick ="[Event Procedure]"
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =5498
                    Top =3401
                    Width =1700
                    Height =340
                    FontSize =9
                    TabIndex =7
                    Name ="btnClose"
                    Caption ="Lukk"
                    OnClick ="[Event Procedure]"
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Public FID As Long
Public myDb As DAO.Database


Public Sub KursSineForelesere(id As Long)
    Dim lvwRS As DAO.Recordset
    Dim itmX As ListItem
    Dim MylvwPersonEmne As ListView
    Dim sqlStr As String
    Dim NoOfEmne As Integer
    Set myDb = CurrentDb()
    GL_EID = id
    'EID = GL_EID
    
    sqlStr = "SELECT tblLarer.Navn, tblLarer.LarerID, tblLarerEmne.* " & _
            "FROM tblLarer INNER JOIN tblLarerEmne ON tblLarer.LarerID = tblLarerEmne.LarerID " & _
            "WHERE (tblLarerEmne.EmneID= " & GL_EID & ");"
    
    Set lvwRS = myDb.OpenRecordset(sqlStr, dbOpenDynaset)
    
    Set MylvwForeleser = Me.lvwForeleser.Object
    MylvwForeleser.ListItems.Clear
    MylvwForeleser.View = lvwReport
         
    While Not lvwRS.EOF
    ' Kode
        If lvwRS.Fields("Navn") <> "" Then
            Set itmX = MylvwForeleser.ListItems.Add(, , lvwRS.Fields("Navn"))
        Else
            Set itmX = MylvwForeleser.ListItems.Add(, , " ")
        End If
    
    ' Studiepoeng
        If lvwRS.Fields("Studiepoeng") <> "" And Not IsNull(lvwRS.Fields("Studiepoeng")) Then
            itmX.SubItems(1) = lvwRS.Fields("Studiepoeng")
        Else
            itmX.SubItems(1) = ""
        End If
    ' Kommentar
        If lvwRS.Fields("Kommentar") <> "" Then
            itmX.SubItems(2) = lvwRS.Fields("Kommentar")
        Else
            itmX.SubItems(2) = ""
        End If
    ' EmneID
        If lvwRS.Fields("tblLarer.LarerID") <> "" And Not IsNull(lvwRS.Fields("tblLarer.LarerID")) Then
            itmX.SubItems(3) = CStr(lvwRS.Fields("tblLarer.LarerID"))
        Else
            itmX.SubItems(3) = ""
        End If
        lvwRS.MoveNext
    Wend
    Me.txtKommentar = ""
    Me.txtStp = ""
    Me.cboLarer = ""
    lvwRS.Close
    myDb.Close

End Sub

Private Sub btnAdd_Click()
On Error GoTo Err_btnAdd_Click
    Dim rsLarerEmne         As DAO.Recordset
    Dim sqlLarerEmne        As String
    Dim msg                 As String
    Dim sqlStr              As String
    Dim sngStp              As Single
    Dim strComment          As String
    
    If Me.cboLarer = "" Or IsNull(FID) Then
        msg = "Ingen lærer er valgt."
        MsgBox msg, vbOKOnly + vbExclamation, OIS_Title
        Exit Sub
    End If
    If Me.txtStp <> "" Then
        sngStp = CSng(Me.txtStp)
    Else
        sngStp = CSng(Form_frmForeleserEmne!txtBelastning)
    End If
    
    Set myDb = CurrentDb
    sqlStr = "INSERT INTO tblLarerEmne (LarerID, EmneID, Studiepoeng, Kommentar) " & _
            "VALUES('" & FID & "', '" & GL_EID & "', '" & sngStp & "', '" & Me.txtKommentar & "');"
    myDb.Execute (sqlStr)
    Call KursSineForelesere(GL_EID)
Exit_btnAdd_Click:
    'myDb.Close
    Exit Sub

Err_btnAdd_Click:
    MsgBox Err.Description, , OIS_Title
    Resume Exit_btnAdd_Click
End Sub


Private Sub btnDelete_Click()
On Error GoTo Err_btnDelete_Click
    Dim MylvwLarer As ListView
    Set MylvwLarer = Me.lvwForeleser.Object
    Dim msg As String
    Dim response As Integer
    Dim sqlStr As String
 
    If MylvwLarer.ListItems.Count < 1 Then
        msg = "Ingen foreleser å fjerne."
        MsgBox msg, vbOKOnly + vbExclamation, OIS_Title
        Exit Sub
    End If
    
    Set myDb = CurrentDb()
    sqlStr = "DELETE * FROM tblLarerEmne WHERE LarerID = " & FID & " AND EmneID = " & GL_EID & ";"
    myDb.Execute (sqlStr)
    ' Reload listview
    Call KursSineForelesere(GL_EID)

Exit_btnDelete_Click:
    'myDb.Close
    Exit Sub

Err_btnDelete_Click:
    MsgBox Err.Description, , OIS_Title
    Resume Exit_btnDelete_Click

End Sub

Private Sub btnUpdate_Click()
On Error GoTo Err_btnUpdate_Click
    Dim MylvwLarer As ListView
    Set MylvwLarer = Me.lvwForeleser.Object
    Dim msg As String
    Dim response As Integer
    Dim sqlStr As String
 
    If MylvwLarer.ListItems.Count < 1 Then
        msg = "Ingenting å oppdatere."
        MsgBox msg, vbOKOnly + vbExclamation, OIS_Title
        Exit Sub
    End If
    
    Set myDb = CurrentDb()
    sqlStr = "UPDATE tblLarerEmne SET Studiepoeng ='" & CSng(Me.txtStp) & "', " & _
                    "Kommentar = '" & Me.txtKommentar & "' " & _
                    "WHERE LarerID = " & FID & " AND EmneID = " & GL_EID & ";"
    myDb.Execute (sqlStr)
    ' Reload listview
    Call KursSineForelesere(GL_EID)

Exit_btnUpdate_Click:
    'myDb.Close
    Exit Sub

Err_btnUpdate_Click:
    MsgBox Err.Description, , OIS_Title
    Resume Exit_btnUpdate_Click

End Sub

Private Sub cboLarer_AfterUpdate()
    If Not IsNull(Me.cboLarer) Then
        FID = Me.cboLarer.Column(1)
        Me.btnAdd.Enabled = True
    End If
End Sub


Private Sub Form_Load()
    Dim KID As Long
    Dim sqlLarer As String
    sqlLarer = "SELECT Navn, LarerID FROM tblLarer ORDER BY Navn"
    Me.cboLarer.RowSource = sqlLarer
    KID = CLng(Form_frmForeleserEmne!txtKursID)
    Me.Caption = Form_frmForeleserEmne!txtEmne & " (" & Form_frmForeleserEmne!txtSted & ")"
    Call KursSineForelesere(KID)
    Me.btnAdd.Enabled = False
    Me.btnUpdate.Enabled = False
    Me.btnDelete.Enabled = False
End Sub

Private Sub lvwForeleser_Click()
    Dim MylwvLarer As ListView
    Dim strLarer As String
    Set MylwvLarer = Me.lvwForeleser.Object
    If MylwvLarer.ListItems.Count > 0 Then
        With MylwvLarer.SelectedItem
            Me.cboLarer = .Text
            Me.txtStp = .SubItems(1)
            Me.txtKommentar = .SubItems(2)
            FID = CLng(.SubItems(3))
        End With
    End If
    Me.btnDelete.Enabled = True
    Me.btnUpdate.Enabled = True
End Sub
Private Sub btnClose_Click()
On Error GoTo Err_btnClose_Click


    DoCmd.Close

Exit_btnClose_Click:
    Exit Sub

Err_btnClose_Click:
    MsgBox Err.Description, , OIS_Title
    Resume Exit_btnClose_Click
    
End Sub
