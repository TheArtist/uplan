Version =20
VersionRequired =20
Begin Form
    Modal = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    TabularFamily =255
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =7313
    DatasheetFontHeight =10
    ItemSuffix =4
    Left =210
    Top =90
    Right =8070
    Bottom =3810
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x751a9027f310e340
    End
    DatasheetFontName ="Arial"
    OnLoad ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
            AsianLineBreak =255
        End
        Begin CustomControl
            SpecialEffect =2
            Width =4536
            Height =2835
        End
        Begin Section
            Height =2948
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin CustomControl
                    Enabled = NotDefault
                    SizeMode =1
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =170
                    Top =230
                    Width =7092
                    Height =2496
                    AutoActivate =1
                    Name ="lvwForeleser"
                    OleData = Begin
                        0x00120000d0cf11e0a1b11ae1000000000000000000000000000000003e000300 ,
                        0xfeff090006000000000000000000000001000000000000000000000000100000 ,
                        0x0600000001000000feffffff0000000001000000ffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff010000004bf0d1bd8b85d111b16a00c0 ,
                        0xf0283628000000000000000000000000b085deee86aac90107000000c0010000 ,
                        0x0000000043006f006e00740065006e0074007300000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000012000201ffffffff02000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000200000024010000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000000000005c000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000fefffffffdfffffffffffffffffffffffffffffffffffffffeffffff ,
                        0xfeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff010000004bf0d1bd8b85d111b16a00c0 ,
                        0xf028362800000000000000000000000080593fe23713c70105000000c0010000 ,
                        0x0000000043006f006e00740065006e0074007300000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000012000201ffffffff02000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000200000003010000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000000000005c000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000fffffffffffffffffefffffffdfffffffefffffffeffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff01000000feffffff03000000040000000500000006000000feffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff5c000000000000000100000000000000000000000000000000000000 ,
                        0x2400000038000000000000000000000000000000000000000000000039333638 ,
                        0x323635452d383546452d313164312d384245332d303030304638373534444131 ,
                        0xe022860902002000000000000000ac1400000500000000000000000000000000 ,
                        0x000005002143341208000000de300000331100004e087deb010006001c000000 ,
                        0x000000000000000000860100de30000001efcdab000005000000000007002a00 ,
                        0x0800008005000080000000000000000000000000000000001fdeecbd01000500 ,
                        0xf0e45b0d04002000000000000000ac1400000900000000000000000000000000 ,
                        0x0000090000004661676ce6726572002000010002000000e40600000b00000000 ,
                        0x00000000000000000000000b00000042656c6173746e696e6700200002000200 ,
                        0x0000ac1400000a0000000000000000000000000000000a0000004b6f6d6d656e ,
                        0x7461720020000300000000000000000003000000000000000000000000000000 ,
                        0x0300000049440000008305000005000000000000000000000000000000050000 ,
                        0x0053746564002000050000000000000000000300000000000000000000000000 ,
                        0x0000030000004944002000060000000000000000000a00000000000000000000 ,
                        0x00000000000a0000004d65726b6e61646572000000000000fcffffff00000000 ,
                        0x0000000001000000feffffff03000000040000000500000006000000feffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff5c000000000000000100000000000000000000000000000000000000 ,
                        0x2400000038000000000000000000000000000000000000000000000039333638 ,
                        0x323635452d383546452d313164312d384245332d303030304638373534444131 ,
                        0xe022860902002000000000000000ac1400000500000000000000000000000000 ,
                        0x000005002143341208000000e3300000281100004e087deb010006001c000000 ,
                        0x000000000000000000860100e330000001efcdab00000500c0ed310707002a00 ,
                        0x080000800500008080972c070000000000000000000000001fdeecbd01000500 ,
                        0xf9962c070352e30b918fce119de300aa004bb851010000009001905f01000654 ,
                        0x61686f6d6104002000000000000000ac14000009000000000000000000000000 ,
                        0x000000090000004661676ce6726572002000010002000000e40600000b000000 ,
                        0x0000000000000000000000000b00000042656c6173746e696e67002000020002 ,
                        0x000000ac1400000a0000000000000000000000000000000a0000004b6f6d6d65 ,
                        0x6e74617200200003000000000000000000030000000000000000000000000000 ,
                        0x0003000000494400050000000000000000000300000000000000000000000000 ,
                        0x0000030000004944002000060000000000000000000a00000000000000000000 ,
                        0x00000000000a0000004d65726b6e61646572000000000000fcffffff00000000 ,
                        0x0000000000000000
                    End
                    OLEClass ="ListViewCtrl"
                    Class ="MSComctlLib.ListViewCtrl.2"
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database

Public Sub KursSineForelesere(id As Long)
    Dim myDb As DAO.Database
    Dim lvwRS As DAO.Recordset
    Dim itmX As ListItem
    Dim MylvwPersonEmne As ListView
    Dim sqlStr As String
    Dim NoOfEmne As Integer
    'Dim stbStatusLine As CustomControl
    Set myDb = CurrentDb()
    GL_EID = id
    EID = GL_EID
    
    'sqlstr = "SELECT tblLarer.Navn, tblLarer.LarerID, tblLarerEmne.* " & _
    '        "FROM tblLarer INNER JOIN tblLarerEmne ON tblLarer.LarerID = tblLarerEmne.LarerID " & _
    '        "WHERE ((tblLarer.LarerID=LarerEmne.LarerID) AND (tblLarerEmne.EmneID= " & EID & "));"
    sqlStr = "SELECT tblLarer.Navn, tblLarer.LarerID, tblLarerEmne.* " & _
            "FROM tblLarer INNER JOIN tblLarerEmne ON tblLarer.LarerID = tblLarerEmne.LarerID " & _
            "WHERE (tblLarerEmne.EmneID= " & EID & ");"
    
    Set lvwRS = myDb.OpenRecordset(sqlStr, dbOpenDynaset)
    
    Set MylvwForeleser = Me.lvwForeleser.Object
    MylvwForeleser.ListItems.Clear
    MylvwForeleser.View = lvwReport
         
    While Not lvwRS.EOF
    ' Kode
        If lvwRS.Fields("Navn") <> "" Then
            Set itmX = MylvwForeleser.ListItems.Add(, , lvwRS.Fields("Navn"))
        Else
            Set itmX = MylvwForeleser.ListItems.Add(, , " ")
        End If
    
    ' Studiepoeng
        If lvwRS.Fields("Studiepoeng") <> "" And Not IsNull(lvwRS.Fields("Studiepoeng")) Then
            itmX.SubItems(1) = lvwRS.Fields("Studiepoeng")
        Else
            itmX.SubItems(1) = ""
        End If
    ' Kommentar
        If lvwRS.Fields("Kommentar") <> "" Then
            itmX.SubItems(2) = lvwRS.Fields("Kommentar")
        Else
            itmX.SubItems(2) = ""
        End If
    ' EmneID
        If lvwRS.Fields("EmneID") <> "" And Not IsNull(lvwRS.Fields("EmneID")) Then
            itmX.SubItems(3) = CStr(lvwRS.Fields("EmneID"))
        Else
            itmX.SubItems(3) = ""
        End If

        lvwRS.MoveNext
    Wend
    lvwRS.Close
    myDb.Close

End Sub




Private Sub Form_Load()
    Dim KID As Long
    KID = CLng(Form_frmForeleserEmne!txtKursID)
    Me.Caption = Form_frmForeleserEmne!txtEmne & " (" & Form_frmForeleserEmne!txtSted & ")"
    Call KursSineForelesere(KID)
End Sub
